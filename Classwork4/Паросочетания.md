Паросочетания



[Очень хорошо рассказано на алгоритмике](https://ru.algorithmica.org/cs/matching/):

1. [то такое паросочетания](https://ru.algorithmica.org/cs/matching/)
2. [Лемма Бержа](https://ru.algorithmica.org/cs/matching/berge/)
3. [Алгоритм Куна](https://ru.algorithmica.org/cs/matching/kuhn/)
4. [Задачи на паросочетания](https://ru.algorithmica.org/cs/matching/matching-problems/)

В п.4 разобрана задача **Кубики** из итоговой работы. 

В задаче из классной работы необходимо просто реализовать алгоритм Куна. 


Еще один код Куна и запуска Куна. Этот код отличается от кода в статье, он сохраняет парсочетания и для правой группы вершин, а также запускается чуть быстрее.

```c++
bool used[N];
int matchForL[N];
int mathForR[M];

std::vector<int> g[N];

bool find(int v) { // v from L
    if (used[v]) return false;
    used[v] = true;
    for (auto u : g[v]) {
        if (mathForR[u] == -1 || find(mathForR[u])) {
            mathForR[u] = v;
            matchForL[v] = u;
            return true;
        }
    }
    return false;
}

void doKuhn() {
    std::fill(matchForL, matchForL + N, -1);
    std::fill(matchForR, matchForR + M, -1);
    bool workFlag = true;
    while (workFlag) {
        workFlag = false;
        std::fill(used, used + N, 0);
        for (int v = 1; v <= n; ++v) {
            if (matchForL[v] != -1) continue;
            workFlag |= find(v);
        }
    }
}
```

