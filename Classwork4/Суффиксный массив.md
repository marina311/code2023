## Суффиксный массив

Довольно сложная и местами неприятная структура данных. 
Однако знание этой темы может пригодиться либо на олимпиадах, 
либо на отборочных к олимпиадам/олимпиадным сборам.


В задачах он часто используется совместно с алгоритмом нахождения массива LCP - 
наибольших общих префиксов двух соседних элементов суффиксного массива. 


[Теория, но код оставляет желать лучшего](https://ru.algorithmica.org/cs/string-structures/suffix-array/)

[Приятный короткий текст, алгоритм за O(n log^2)](https://codeforces.com/blog/entry/66540)

[Лаконичный код за O(n log(n))](https://pastebin.com/d6Fm30ZD)

[Презентация с картинками и объяснениями](https://acm.math.spbu.ru/~sk1/download/books/SuffixDataStructures.pdf)

[Задачи на суфмас, по ссылкам можно перейти и к самому алгоритму](https://neerc.ifmo.ru/wiki/index.php?title=%D0%A1%D1%83%D1%84%D1%84%D0%B8%D0%BA%D1%81%D0%BD%D1%8B%D0%B9_%D0%BC%D0%B0%D1%81%D1%81%D0%B8%D0%B2)


Неплохо, если удастся разобраться в алгоритме построения суффиксного массива. Для решения задач в работе достаточно воспользоваться одной из готовых реализаций.

Главное, понять, как с помощью суффиксного массива решать задачи на строки.

### Задача **Суффиксный массив** из классной работы. 

Просто реализовать любой из предложенных алгоритмов. 


### Задача **LCP** из домашней работы.

Реализовать алгоритм построения LCP [напр. алгоритм Касаи](https://neerc.ifmo.ru/wiki/index.php?title=%D0%90%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC_%D0%9A%D0%B0%D1%81%D0%B0%D0%B8_%D0%B8_%D0%B4%D1%80.)

### Задача **Башни** из домашней работы. 

Просто реализуем написанное. К каждой последовательности допишем в конец ее копию.

Вместо всех циклических сдвигов будем использовать суффиксный массив для полученного массива последовательностей.

Построим массив LCP. Он нам и нужен в итоге (только проверяем, что мы суммируем значения не больше, чем n).


### Задача **Подстроки** из домашней работы.

Подумать, как связан массив LCP и количество повторяющихся подстрок. 

Спойлер: из общего кол-ва всех подстрок вычитаем сумму массива LCP. И все.

